
  
    

        create or replace transient table BRONZE.audit.sat_ma_order_lineitem_details  as
        (-- Generated by dbtvault.

    


WITH source_data AS (
    SELECT DISTINCT s.ORDER_PK, s.ORDERKEY, s.LINENUMBER, s.COMMITDATE, s.DISCOUNT, s.EXTENDEDPRICE, s.LINE_COMMENT, s.QUANTITY, s.RECEIPTDATE, s.RETURNFLAG, s.SHIPDATE, s.SHIPINSTRUCT, s.SHIPMODE, s.TAX, s.MA_LINEITEM_HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    
    FROM BRONZE.audit.v_stg_orders AS s
    WHERE s.ORDER_PK IS NOT NULL
        AND s.ORDERKEY IS NOT NULL
        AND s.LINENUMBER IS NOT NULL
),



records_to_insert AS (
    SELECT source_data.ORDER_PK, source_data.ORDERKEY, source_data.LINENUMBER, source_data.COMMITDATE, source_data.DISCOUNT, source_data.EXTENDEDPRICE, source_data.LINE_COMMENT, source_data.QUANTITY, source_data.RECEIPTDATE, source_data.RETURNFLAG, source_data.SHIPDATE, source_data.SHIPINSTRUCT, source_data.SHIPMODE, source_data.TAX, source_data.MA_LINEITEM_HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data


)

SELECT * FROM records_to_insert
        );
      
  