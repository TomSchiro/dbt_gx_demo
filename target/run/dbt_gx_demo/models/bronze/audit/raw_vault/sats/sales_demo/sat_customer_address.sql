
  
    

        create or replace transient table BRONZE.audit.sat_customer_address  as
        (-- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.LINK_CUSTOMER_ADDRESS_PK, a.CUSTOMER_ADDRESS_HASHDIFF, a.CA_STREET_NUMBER, a.CA_STREET_TYPE, a.CA_SUITE_NUMBER, a.CA_CITY, a.CA_COUNTY, a.CA_STATE, a.CA_COUNTRY, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM BRONZE.audit.v_stg_customer_info AS a
    WHERE a.LINK_CUSTOMER_ADDRESS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINK_CUSTOMER_ADDRESS_PK, stage.CUSTOMER_ADDRESS_HASHDIFF, stage.CA_STREET_NUMBER, stage.CA_STREET_TYPE, stage.CA_SUITE_NUMBER, stage.CA_CITY, stage.CA_COUNTY, stage.CA_STATE, stage.CA_COUNTRY, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert a
        );
      
  