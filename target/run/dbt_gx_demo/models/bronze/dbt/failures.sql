-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into BRONZE.DBT.failures as DBT_INTERNAL_DEST
        using BRONZE.DBT.failures__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.result_id = DBT_INTERNAL_DEST.result_id
            )

    
    when matched then update set
        "RESULT_ID" = DBT_INTERNAL_SOURCE."RESULT_ID","INVOCATION_ID" = DBT_INTERNAL_SOURCE."INVOCATION_ID","UNIQUE_ID" = DBT_INTERNAL_SOURCE."UNIQUE_ID","DATABASE_NAME" = DBT_INTERNAL_SOURCE."DATABASE_NAME","SCHEMA_NAME" = DBT_INTERNAL_SOURCE."SCHEMA_NAME","NAME" = DBT_INTERNAL_SOURCE."NAME","RESOURCE_TYPE" = DBT_INTERNAL_SOURCE."RESOURCE_TYPE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","EXECUTION_TIME" = DBT_INTERNAL_SOURCE."EXECUTION_TIME","ROWS_AFFECTED" = DBT_INTERNAL_SOURCE."ROWS_AFFECTED","ERROR_MESSAGE" = DBT_INTERNAL_SOURCE."ERROR_MESSAGE"
    

    when not matched then insert
        ("RESULT_ID", "INVOCATION_ID", "UNIQUE_ID", "DATABASE_NAME", "SCHEMA_NAME", "NAME", "RESOURCE_TYPE", "STATUS", "EXECUTION_TIME", "ROWS_AFFECTED", "ERROR_MESSAGE")
    values
        ("RESULT_ID", "INVOCATION_ID", "UNIQUE_ID", "DATABASE_NAME", "SCHEMA_NAME", "NAME", "RESOURCE_TYPE", "STATUS", "EXECUTION_TIME", "ROWS_AFFECTED", "ERROR_MESSAGE")

;
    commit;